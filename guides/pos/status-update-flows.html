

<!DOCTYPE html>

	<html lang="en-GB">

	<head>
		<meta charset="UTF-8">
		<meta http-equiv="x-ua-compatible" content="ie=edge">
		<meta name="viewport" content="width=device-width, minimum-scale=1.0">
		
			<title>Status update flows | AEVI AppFlow</title>
		
		
			<meta name="description" content="How to send status updates">
		
		
		<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=IBM+Plex+Mono|IBM+Plex+Sans:400,400i,500,500i,700,700i">
		<link rel="stylesheet" href="/pos-android-sdk/dox-theme/assets/css/style.css">
		<link rel="icon" href="/pos-android-sdk/icon_large.png" sizes="32x32">
		<link rel="icon" href="/pos-android-sdk/icon_large.png" sizes="192x192">
		<link rel="apple-touch-icon-precomposed" href="/pos-android-sdk/icon_large.png">
		<meta name="msapplication-TileImage" content="/pos-android-sdk/icon_large.png">
	</head>
	<body>
		
			<div class="c-offcanvas">
				<div class="c-offcanvas__inner">
					
						<ul class="c-nav c-nav--stacked u-mx-auto">
							
								<li><a href="/pos-android-sdk/appflow-overview">Overview</a></li>
							
								<li><a href="/pos-android-sdk/guides">Guides</a></li>
							
								<li><a href="/pos-android-sdk/technical">Technical Docs</a></li>
							
						</ul><!-- /.c-nav -->
					
					
						
							<a href="/technical/javadocs" class="c-btn c-btn--md c-btn--gray u-text-md">
								Reference
								<div class="c-btn__icon">
									<i class="o-icon o-icon--folder"></i>
								</div>
							</a>
						
					
				</div><!-- /.c-offcanvas__inner -->
			</div><!-- /.c-offcanvas -->
		

		
			<header class="c-header">
				<div class="o-container">
					<div class="o-row">
						<div class="o-col-12">
							<div class="u-flex u-items-center">
								
									<div class="c-logo">
										<a href="/pos-android-sdk/" class="c-logo__link">
											<img src="/pos-android-sdk/aevi_logo.svg">
										</a><!-- /.c-logo__link -->
									</div><!-- /.c-logo -->
								
								
									<div class="u-flex u-items-center u-ml-auto">
										
											<ul class="c-nav u-mb-0 u-hidden u-block@lg">
												
													
													<li class=""><a href="/pos-android-sdk/appflow-overview">Overview</a></li>
												
													
													<li class=""><a href="/pos-android-sdk/guides">Guides</a></li>
												
													
													<li class=""><a href="/pos-android-sdk/technical">Technical Docs</a></li>
												
											</ul><!-- /.c-nav -->
										
										
											<div class="u-ml-5 u-hidden u-block@lg">
												
													<a href="/pos-android-sdk/technical/javadocs" class="c-btn c-btn--md c-btn--gray u-text-md">
														Reference
														<div class="c-btn__icon">
															<i class="o-icon o-icon--folder"></i>
														</div>
													</a>
												
											</div>
										
									</div>
								
								<button class="c-hamburger-icon c-hamburger-icon--slider js-hamburger-icon js-offcanvas-toggle u-ml-auto u-hidden@lg" type="button">
									<span class="c-hamburger-icon__box">
										<span class="c-hamburger-icon__inner"></span>
									</span><!-- /.c-hamburger-icon__box -->
								</button><!-- /.c-hamburger-icon -->
							</div>
						</div><!-- /.o-col -->
					</div><!-- /.o-row -->
				</div><!-- /.o-container -->
			</header><!-- /.c-header -->
		







	
		<div class="c-hero u-bg-gray-30 u-pt-16 u-pb-10">
	
		<div class="o-container">
			<div class="o-row">
				<div class="o-col-10@lg o-col-9@xl">
					
						<h2 class="u-text-lg u-text-xl@sm">Flow Initiation</h2>
					
					
						<div class="u-h6">
							<p>How to send status updates</p>
						</div>
					
					
					
				</div><!-- /.o-col -->
			</div><!-- /.o-row -->
		</div><!-- /.o-container -->
	</div>






	<div class="u-pt-8 u-pb-5">
		<div class="o-container">
			<div class="o-row">
				
					<div class="o-col-8@lg o-col-7@xl">
						<div class="c-post u-mb-3@lg js-post">
							<h1 id="status-update-flows">Status Update Flows</h1>

<p>In addition to the standard flows that are defined to perform a certain <em>action</em>, like a purchase, or generating a token, AppFlow also enables applications to provide status updates via flows. These status updates can be of any nature that involves passing some data to one or multiple applications.</p>

<p>Unlike the normal generic flows (such as tokenisation) where a single application handles the request and passes back a response with an outcome, these flows allow multiple applications to be called in sequence for the purpose of reading input data. The application can choose to not send any data back, or to pass back a set of references. FPS will collate all references from the applications and pass back in the final <code class="highlighter-rouge">Response</code> back to the client.</p>

<p>These flows are processed via a request queue in the background, separately from the standard flows. Applications in these flows may not launch any user interface - they must handle the update in the service only. Responses to status updates come in via the <code class="highlighter-rouge">BaseResponseListenerService.notifyStatusUpdateResponse()</code> callback method. If the client application is not interested in the responses, this method can be left empty.</p>

<p>Two common kinds of status update include updates to Baskets and updates to Customer details. The data that can be sent for these type of flow is defined in the sections below.</p>

<h2 id="basket-status-updates">Basket Status Updates</h2>

<p>Most POS applications deal with a basket to represent the goods or services for a customer. Usually a basket is passed to a payment flow where flow services can read and augment it. There are also scenarios where applications need to react to basket updates in real time e.g. before the payment flow is initiated.</p>

<p>To support this scenario, a <code class="highlighter-rouge">basketStatusUpdate</code> flow can be used.</p>

<h3 id="data-keys">Data keys</h3>

<p>See <a href="https://github.com/AEVI-AppFlow/api-constants/blob/master/api-constants/src/main/java/com/aevi/sdk/flow/constants/StatusUpdateKeys.java">StatusUpdateKeys</a> for defined constants.</p>

<table>
  <thead>
    <tr>
      <th>Data key</th>
      <th>Value</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>“basketUpdated”</td>
      <td>Basket</td>
      <td>Send the entire basket in the update</td>
    </tr>
    <tr>
      <td>“basketItemsAdded”</td>
      <td>BasketItem[]</td>
      <td>Send newly added basket items</td>
    </tr>
    <tr>
      <td>“basketItemsRemoved”</td>
      <td>BasketItem[]</td>
      <td>Send newly removed basket items</td>
    </tr>
    <tr>
      <td>“basketItemUpdated”</td>
      <td>BasketItem</td>
      <td>Send a single updated basket item</td>
    </tr>
  </tbody>
</table>

<h3 id="initialise-request">Initialise request</h3>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="n">Request</span> <span class="n">basketUpdateRequest</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Request</span><span class="o">(</span><span class="s">"basketStatusUpdate"</span><span class="o">);</span>

<span class="c1">// Example of a single data key - see more examples in data keys section</span>
<span class="n">basketUpdateRequest</span><span class="o">.</span><span class="na">addAdditionalData</span><span class="o">(</span><span class="s">"basketUpdated"</span><span class="o">,</span> <span class="n">myBasket</span><span class="o">);</span>
</code></pre>
</div>

<h3 id="create-and-parse-response">Create and parse response</h3>
<p>TODO - unclear what the responses would be here?</p>

<h2 id="customer-status-updates">Customer Status Updates</h2>

<p>Flow initiation applications may support identifying customers and keep associated customer details, such as name, tokens, etc. For these purposes, AppFlow has the <code class="highlighter-rouge">Customer</code> model. If a customer has been identified and/or updated, the initiation application can notify interested parties of this via the use of a <code class="highlighter-rouge">customerStatusUpdate</code> flow.</p>

<h3 id="data-keys-1">Data keys</h3>

<p>See <a href="https://github.com/AEVI-AppFlow/api-constants/blob/master/api-constants/src/main/java/com/aevi/sdk/flow/constants/StatusUpdateKeys.java">StatusUpdateKeys</a> for defined constants.</p>

<table>
  <thead>
    <tr>
      <th>Data key</th>
      <th>Value</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>“customerUpdate”</td>
      <td>Customer</td>
      <td>Send customer details</td>
    </tr>
  </tbody>
</table>

<h3 id="initialise-request-1">Initialise request</h3>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="n">Request</span> <span class="n">customerUpdateRequest</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Request</span><span class="o">(</span><span class="s">"customerStatusUpdate"</span><span class="o">);</span>
<span class="n">customerUpdateRequest</span><span class="o">.</span><span class="na">addAdditionalData</span><span class="o">(</span><span class="s">"customerUpdate"</span><span class="o">,</span> <span class="n">myCustomer</span><span class="o">);</span>
</code></pre>
</div>

<h3 id="create-and-parse-response-1">Create and parse response</h3>
<p>TODO - unclear what the responses would be here?</p>


							

						</div><!-- /.c-post -->
					</div><!-- /.o-col -->
				
				
					<div class="o-col-3@lg o-offset-1@lg o-offset-2@xl">
						<ul class="c-page-nav u-sticky u-pin-t-6 u-mt-4 u-mt-1@lg u-mb-1 u-mb-4@lg">
							
							
							
								
								
									
										<li class="is-active">
											<a href="/pos-android-sdk/guides/pos/pre-requisites">
												<p class="c-page-nav__heading">Pre-requisites</p>
											</a>
										</li>
									
									
								
							
								
								
									
										<li class="is-active">
											<a href="/pos-android-sdk/guides/pos/flow-initiation">
												<p class="c-page-nav__heading">Flow initiation</p>
											</a>
										</li>
									
									
								
							
								
								
									
										<li class="is-active">
											<a href="/pos-android-sdk/guides/pos/flow-response-listeners">
												<p class="c-page-nav__heading">Flow response listener</p>
											</a>
										</li>
									
									
								
							
								
								
									
										<li class="is-active">
											<a href="/pos-android-sdk/guides/pos/handling-responses">
												<p class="c-page-nav__heading">Handling responses</p>
											</a>
										</li>
									
									
								
							
								
								
									
										<li class="is-active">
											<a href="/pos-android-sdk/guides/pos/handling-errors">
												<p class="c-page-nav__heading">Handling errors</p>
											</a>
										</li>
									
									
								
							
								
								
									
										<li class="is-active">
											<a href="/pos-android-sdk/guides/pos/status-update-flows">
												<p class="c-page-nav__heading">Status update flows</p>
											</a>
										</li>
									
									
								
							
								
								
									
										<li>
											<a href="/pos-android-sdk/guides/pos/querying-for-information">
												<p class="c-page-nav__heading">Querying for information</p>
											</a>
										</li>
									
									
								
							
								
								
									
										<li>
											<a href="/pos-android-sdk/guides/pos/query-for-devices">
												<p class="c-page-nav__heading">Query for devices</p>
											</a>
										</li>
									
									
								
							
						</ul><!-- /.c-page-nav -->
					</div><!-- /.o-col -->
				
			</div><!-- /.o-row -->
		</div><!-- /.o-container -->
	</div>



	
	
		<div class="u-bg-primary u-text-white u-pt-3 u-pt-4@sm u-pb-3 u-pb-4@sm">
			<div class="o-container">
				<div class="o-row">
					<div class="o-col-12 u-text-center">
						<div class="u-inline-block u-flex@sm">
							
							
							 	
							
							 	
							
							 	
							
							 	
							
							 	
							
							 	
								  
									
									
									
									
										<a href="/pos-android-sdk/guides/pos/handling-errors" class="c-arrow-link c-arrow-link--prev u-mr-auto">Handling errors</a>
									
									
										<a href="/pos-android-sdk/guides/pos/querying-for-information" class="c-arrow-link c-arrow-link--next u-ml-auto">Querying for information</a>
									
								
							
							 	
							
							 	
							
						</div>
					</div><!-- /.o-col -->
				</div><!-- /.o-row -->
			</div><!-- /.o-container -->
		</div>
		

		
			<footer class="c-footer">
				<div class="o-container">
					<div class="o-row">
						<div class="o-col-12 u-mt-6 u-mt-8@md u-mb-4 u-mb-6@md">
							
								<p class="c-logo u-mb-1">
									AEVI AppFlow
								</p><!-- /.c-logo -->
							
							
								<p>Copyright &copy;2019. - AEVI International GmbH <br>All rights reserved.</p>
							
						</div><!-- /.o-col -->
					</div><!-- /.o-row -->
				</div><!-- /.o-container -->
			</footer><!-- /.c-footer -->
		

		<script type="text/javascript" src="/pos-android-sdk/dox-theme/assets/js/vendor/jquery-3.3.1.min.js"></script>
		<script type="text/javascript" src="/pos-android-sdk/dox-theme/assets/js/scripts.min.js"></script>

		

	</body>
</html>

	

