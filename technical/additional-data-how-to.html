

<!DOCTYPE html>

	<html lang="en-GB">

	<head>
		<meta charset="UTF-8">
		<meta http-equiv="x-ua-compatible" content="ie=edge">
		<meta name="viewport" content="width=device-width, minimum-scale=1.0">
		
			<title>Using Additional Data | AEVI AppFlow</title>
		
		
			<meta name="description" content="How to add your own data to a flow">
		
		
		<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=IBM+Plex+Mono|IBM+Plex+Sans:400,400i,500,500i,700,700i">
		<link rel="stylesheet" href="/pos-android-sdk/dox-theme/assets/css/style.css">
		<link rel="icon" href="/pos-android-sdk/icon_large.png" sizes="32x32">
		<link rel="icon" href="/pos-android-sdk/icon_large.png" sizes="192x192">
		<link rel="apple-touch-icon-precomposed" href="/pos-android-sdk/icon_large.png">
		<meta name="msapplication-TileImage" content="/pos-android-sdk/icon_large.png">
	</head>
	<body>
		
			<div class="c-offcanvas">
				<div class="c-offcanvas__inner">
					
						<ul class="c-nav c-nav--stacked u-mx-auto">
							
								<li><a href="/pos-android-sdk/appflow-overview">Overview</a></li>
							
								<li><a href="/pos-android-sdk/guides">Guides</a></li>
							
								<li><a href="/pos-android-sdk/technical">Technical Docs</a></li>
							
						</ul><!-- /.c-nav -->
					
					
						
							<a href="/technical/javadocs" class="c-btn c-btn--md c-btn--gray u-text-md">
								Reference
								<div class="c-btn__icon">
									<i class="o-icon o-icon--folder"></i>
								</div>
							</a>
						
					
				</div><!-- /.c-offcanvas__inner -->
			</div><!-- /.c-offcanvas -->
		

		
			<header class="c-header">
				<div class="o-container">
					<div class="o-row">
						<div class="o-col-12">
							<div class="u-flex u-items-center">
								
									<div class="c-logo">
										<a href="/pos-android-sdk/" class="c-logo__link">
											<img src="/pos-android-sdk/aevi_logo.svg">
										</a><!-- /.c-logo__link -->
									</div><!-- /.c-logo -->
								
								
									<div class="u-flex u-items-center u-ml-auto">
										
											<ul class="c-nav u-mb-0 u-hidden u-block@lg">
												
													
													<li class=""><a href="/pos-android-sdk/appflow-overview">Overview</a></li>
												
													
													<li class=""><a href="/pos-android-sdk/guides">Guides</a></li>
												
													
													<li class=""><a href="/pos-android-sdk/technical">Technical Docs</a></li>
												
											</ul><!-- /.c-nav -->
										
										
											<div class="u-ml-5 u-hidden u-block@lg">
												
													<a href="/pos-android-sdk/technical/javadocs" class="c-btn c-btn--md c-btn--gray u-text-md">
														Reference
														<div class="c-btn__icon">
															<i class="o-icon o-icon--folder"></i>
														</div>
													</a>
												
											</div>
										
									</div>
								
								<button class="c-hamburger-icon c-hamburger-icon--slider js-hamburger-icon js-offcanvas-toggle u-ml-auto u-hidden@lg" type="button">
									<span class="c-hamburger-icon__box">
										<span class="c-hamburger-icon__inner"></span>
									</span><!-- /.c-hamburger-icon__box -->
								</button><!-- /.c-hamburger-icon -->
							</div>
						</div><!-- /.o-col -->
					</div><!-- /.o-row -->
				</div><!-- /.o-container -->
			</header><!-- /.c-header -->
		


<div class="u-bg-gray-30 u-pt-8 u-pb-10">
</div>


		<div class="o-container">
			<div class="o-row">
				<div class="o-col-8@lg o-col-7@xl">
						<h2 class="u-text-lg u-text-xl@sm">Using Additional Data</h2>
				</div>
			</div>
		</div>
		<div class="o-container">
			<div class="o-row">
				
					<div class="o-col-12@lg o-col-11@xl">
						<div class="c-post u-mb-3@lg js-post">
							<p>Many of the AppFlow data models contain an <code class="highlighter-rouge">AdditionalData</code> object. This object is essentially a bucket for storing any kind of data. This <code class="highlighter-rouge">AdditionalData</code> will be passed around with the primary flow data and can be accessed for read and write by flow services.</p>

<h2 id="adding-data">Adding data</h2>

<p>Simple data types and complex objects can be stored. However, regardless of the object type stored it must be able to be serialised to JSON. Primitive types String, int, and boolean are supported and will be automatically converted. Arrays of the same type of data can also be stored.</p>

<p>Data is added using the <code class="highlighter-rouge">addData</code> method along with a key that they should be stored against.</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="n">additionalData</span><span class="o">.</span><span class="na">addData</span><span class="o">(</span><span class="s">"myExtra"</span><span class="o">,</span> <span class="s">"ext"</span><span class="o">);</span> <span class="c1">// store a String</span>
<span class="n">additionalData</span><span class="o">.</span><span class="na">addData</span><span class="o">(</span><span class="s">"myBoolean"</span><span class="o">,</span> <span class="kc">true</span><span class="o">);</span> <span class="c1">// store a boolean</span>
<span class="n">additionalData</span><span class="o">.</span><span class="na">addData</span><span class="o">(</span><span class="s">"myInt"</span><span class="o">,</span> <span class="mi">42322</span><span class="o">);</span> <span class="c1">// store an int</span>
<span class="n">additionalData</span><span class="o">.</span><span class="na">addData</span><span class="o">(</span><span class="s">"myLong"</span><span class="o">,</span> <span class="mi">7736663L</span><span class="o">);</span> <span class="c1">// store a long</span>
</code></pre>
</div>
<p>To get the data stored back at a later point the <code class="highlighter-rouge">getValue</code> method will return it automatically converted back to the original type. e.g.</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kt">long</span> <span class="n">myLong</span> <span class="o">=</span> <span class="n">additionalData</span><span class="o">.</span><span class="na">getValue</span><span class="o">(</span><span class="s">"myLong"</span><span class="o">);</span>
</code></pre>
</div>

<p>If an attempt is made to get the data back as a different type then a null/empty value will be returned e.g.</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="n">String</span> <span class="n">str</span> <span class="o">=</span> <span class="n">additionalData</span><span class="o">.</span><span class="na">getValue</span><span class="o">(</span><span class="s">"myLong"</span><span class="o">);</span>
<span class="c1">// str above will be null</span>
</code></pre>
</div>

<p>Helper methods are available to return primitive String, int and boolean <code class="highlighter-rouge">getStringValue</code>, <code class="highlighter-rouge">getIntegerValue</code> and <code class="highlighter-rouge">getBooleanValue</code>. Each of these can also optionally include the passing of a default if the key (of the correct type) is not found.</p>

<h2 id="complex-objects">Complex objects</h2>

<p>If a complex object is added to the additional data then when it is passed between flow services it will be serialized to JSON and stored in the data along with a field indicating the object type. Therefore, any object stored must be capable of being serialised. Generally speaking the objects stored should be simple POJO objects. You may also wish to use our own <code class="highlighter-rouge">Jsonable</code> interface to mark the class as able to be converted to/from JSON (for more details about <code class="highlighter-rouge">Jsonable</code> see our <a href="https://github.com/Aevi-UK/json-utils">json-utils repo</a> ). If this object is to be passed between one or more flow services they must both have access to the class in there classpath in order that it can be de-serialised correctly.</p>

<p>Complex objects are stored in the same way a primitive types and retrieved by adding the class to the <code class="highlighter-rouge">getValue</code> method e.g.</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="n">Customer</span> <span class="n">customer</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Customer</span><span class="o">(</span><span class="s">"123"</span><span class="o">);</span>
<span class="n">additionalData</span><span class="o">.</span><span class="na">addData</span><span class="o">(</span><span class="s">"customer"</span><span class="o">,</span> <span class="n">customer</span><span class="o">);</span>

<span class="c1">// reading the customer object back</span>
<span class="n">Customer</span> <span class="n">customerRet</span> <span class="o">=</span> <span class="n">additionalData</span><span class="o">.</span><span class="na">getValue</span><span class="o">(</span><span class="s">"customer"</span><span class="o">,</span> <span class="n">Customer</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
</code></pre>
</div>

<p>If you need to store your object as it own super type and not the actual subclass you can specify the type it is stored as using the <code class="highlighter-rouge">addDataWithType</code> method.</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="n">Dog</span> <span class="n">dog</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Dog</span><span class="o">(</span><span class="s">"rover"</span><span class="o">);</span>
<span class="n">additionalData</span><span class="o">.</span><span class="na">addDataWithType</span><span class="o">(</span><span class="s">"myPet"</span><span class="o">,</span> <span class="n">dog</span><span class="o">,</span> <span class="n">Animal</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</code></pre>
</div>

<h2 id="arrays">Arrays</h2>

<p>Arrays can be simply stored and retrieved as above.</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="n">additionalData</span><span class="o">.</span><span class="na">addData</span><span class="o">(</span><span class="s">"myArray"</span><span class="o">,</span> <span class="s">"hello"</span><span class="o">,</span> <span class="s">"bye"</span><span class="o">,</span> <span class="s">"hi"</span><span class="o">,</span> <span class="s">"goodbye"</span><span class="o">);</span>
<span class="n">String</span><span class="o">[]</span> <span class="n">myArrayVals</span> <span class="o">=</span> <span class="n">additionalData</span><span class="o">.</span><span class="na">getValue</span><span class="o">(</span><span class="s">"myArray"</span><span class="o">,</span> <span class="n">String</span><span class="o">[].</span><span class="na">class</span><span class="o">)</span>
</code></pre>
</div>

<h2 id="extra-finders-and-utilities">Extra finders and utilities</h2>

<h4 id="get-all-data-by-type">Get all data by type</h4>

<p>The <code class="highlighter-rouge">getDataOfType</code> method will scan an entire <code class="highlighter-rouge">AdditionalData</code> object for all instances stored of the type given.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>additionalData.addData("one", 1);
additionalData.addData("two", 2);
additionalData.addData("three", "hello");

Map&lt;String, Integer&gt; dataOfType = additionalData.getDataOfType(Integer.class);
</code></pre>
</div>

<p>The code above will return a <code class="highlighter-rouge">Map</code> containing two integers</p>

<h4 id="get-classname-of-data">Get classname of data</h4>

<p>Occasionally it may be useful to know the class type of a data key before attempting to get it. This can be done by using the <code class="highlighter-rouge">getValueClassName</code> simply passing in the key you want to know the class type of, which will be returned as a String.</p>

<h4 id="cleaning-up">Cleaning up</h4>

<p>Various clear, remove methods are also available to delete and remove keys from the additional data.</p>

							

						</div><!-- /.c-post -->
					</div><!-- /.o-col -->
				
			</div><!-- /.o-row -->
		</div><!-- /.o-container -->




		
			<footer class="c-footer">
				<div class="o-container">
					<div class="o-row">
						<div class="o-col-12 u-mt-6 u-mt-8@md u-mb-4 u-mb-6@md">
							
								<p class="c-logo u-mb-1">
									AEVI AppFlow
								</p><!-- /.c-logo -->
							
							
								<p>Copyright &copy;2019. - AEVI International GmbH <br>All rights reserved.</p>
							
						</div><!-- /.o-col -->
					</div><!-- /.o-row -->
				</div><!-- /.o-container -->
			</footer><!-- /.c-footer -->
		

		<script type="text/javascript" src="/pos-android-sdk/dox-theme/assets/js/vendor/jquery-3.3.1.min.js"></script>
		<script type="text/javascript" src="/pos-android-sdk/dox-theme/assets/js/scripts.min.js"></script>

		

	</body>
</html>

